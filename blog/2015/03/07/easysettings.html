<!DOCTYPE html><html><head><meta charset="utf-8" /><title>nownab.log - EasySettingsをSettingslogicの替りにいかがでしょうか</title><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><link href="https://storage.googleapis.com/code.getmdl.io/1.0.4/material.light_blue-pink.min.css" rel="stylesheet" /><script src="https://storage.googleapis.com/code.getmdl.io/1.0.0/material.min.js"></script><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" /><link href="../../../../stylesheets/blog.css" rel="stylesheet" /><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" /></head><body><div class="mdl-layout mdl-js-layout" id="container"><header><h1 id="title"><a href="/blog">nownab.log</a><small><i class="material-icons md-18">description</i><span id="subtitle">logger.level = Logger::DEBUG</span></small></h1></header><div id="main" role="main"><p>今までRailsとかその他諸々のアプリケーションで、定数の管理に<a href="https://github.com/settingslogic/settingslogic">Settingslogic</a>を使ってました。
色々不満がありつつ使ってたんですが、この度<a href="https://rubygems.org/gems/easy_settings">EasySettings</a>というGemを新しく作りました。</p>

<p>[https://github.com/nownabe/easy_settings:embed]</p>

<p>[https://github.com/nownabe/easy_settings:title]</p>

<p>元々はアプリ側でデフォルト値を設定したくて<a href="https://rubygems.org/gems/settingslogic_default">SettingslogicDefault</a>みたいなGemを作ったんですが、色々と限界を感じたのでもう新しいの作ってしまおうと。</p>

<h2 id="section">初期化いらず</h2>
<p>```ruby
# EasySettings
# いらない</p>

<h1 id="settingslogic">Settingslogic</h1>
<p>class Settings &lt; Settingslogic
   source Rails.root.join("config/settings.yml").to_s
end
```</p>

<h2 id="section-1">メソッド形式での動的代入ができる</h2>
<p>```ruby
# EasySettings
&gt; EasySettings.foo ||= "bar"
=&gt; "bar"</p>

<h1 id="settingslogic-1">Settingslogic</h1>
<blockquote>
  <p>Settings.foo ||= "bar"
Settingslogic::MissingSetting: Missing setting 'foo' in settings1.yml
```</p>
</blockquote>

<h2 id="hash">ネストされたHashで同じキーが使える</h2>
<p>というか使えないSettingslogicにびっくり。</p>

<p>```ruby
# EasySettings
&gt; EasySettings["foo"] = {foo: "bar"}
=&gt; {:foo=&gt;"bar"}
&gt; EasySettings.foo.foo
=&gt; "bar"</p>

<h1 id="settingslogic-2">Settingslogic</h1>
<blockquote>
  <p>Settings["foo"] = {foo: "bar"}
=&gt; {:foo=&gt;"bar"}
Settings.foo.foo
Settingslogic::MissingSetting: Missing setting 'foo' in settings.yml
```</p>
</blockquote>

<h2 id="section-2">デフォルト値が設定できる</h2>
<p>元々これをやりたかったんですが、あんまりいらない気もする。
デフォルト値設定を簡潔に書きたくてこういう仕様にしました。</p>

<p><code>ruby
&gt; EasySettings.foo
=&gt; nil
&gt; EasySettings.has_key?(:foo)
=&gt; false
&gt; EasySettings.foo("bar")
=&gt; "bar"
&gt; EasySettings.foo
=&gt; "bar"
&gt; EasySettings.foo("baz")
=&gt; "bar"
</code></p>

<p>こんなこともできます。</p>

<p><code>ruby
&gt; EasySettings.foo({}).bar("baz")
=&gt; "baz"
&gt; EasySettings.to_h
=&gt; {"foo"=&gt;{"bar"=&gt;"baz"}}
</code></p>

<p>Settingslogicだとできない。</p>

<p><code>ruby
&gt; (Settings[:foo] ||= {})[:bar] ||= "baz"
=&gt; "baz"
&gt; Settings[:foo][:bar]
=&gt; nil
</code></p>

<p>詳しい使い方はGithubのREADMEに書いてます。</p>

<p>是非、使ってみてください。</p>
</div><aside><h2>Recent Articles</h2><ol><li><a href="/blog/2015/09/22/test.html">Example Article</a><span>Sep 22</span></li><li><a href="/blog/2015/08/31/redundant-geminabox.html">Gem in a Boxの冗長化</a><span>Aug 31</span></li><li><a href="/blog/2015/08/10/idcf-dns.html">お名前.comからIDCF DNSに移行した話</a><span>Aug 10</span></li><li><a href="/blog/2015/08/09/raspberry-pi-lchika.html">今更Raspberry PiでLチカやってみた</a><span>Aug  9</span></li><li><a href="/blog/2015/05/24/intro-headphone-amp.html">機材紹介：ヘッドホンアンプ</a><span>May 24</span></li><li><a href="/blog/2015/05/21/backup-to-idcf.html">超簡単にサーバのデータをIDCFオブストに定期バックアップするItamaeプラグイン</a><span>May 21</span></li><li><a href="/blog/2015/05/20/release-to-geminabox.html">Gem in a Boxに簡単にリリースできるGem作ったけどいっぱいあったのでまとめ</a><span>May 20</span></li><li><a href="/blog/2015/05/17/intro-wind-chime.html">機材紹介：ウィンドチャイム</a><span>May 17</span></li><li><a href="/blog/2015/04/19/github-pages.html">Github Pagesが便利すぎてイイ</a><span>Apr 19</span></li><li><a href="/blog/2015/03/14/serverfesta.html">サバフェス始まりました</a><span>Mar 14</span></li></ol><h2>Tags</h2><ol><li><a href="/blog/tags/band.html">band (2)</a></li><li><a href="/blog/tags/instruments.html">instruments (3)</a></li><li><a href="/blog/tags/drums.html">drums (2)</a></li><li><a href="/blog/tags/tech.html">tech (8)</a></li><li><a href="/blog/tags/ruby.html">ruby (4)</a></li><li><a href="/blog/tags/geminabox.html">geminabox (2)</a></li><li><a href="/blog/tags/itamae.html">itamae (1)</a></li><li><a href="/blog/tags/idcf.html">idcf (2)</a></li><li><a href="/blog/tags/diary.html">diary (4)</a></li><li><a href="/blog/tags/leveldb.html">leveldb (1)</a></li><li><a href="/blog/tags/ruboty.html">ruboty (1)</a></li><li><a href="/blog/tags/dns.html">dns (1)</a></li><li><a href="/blog/tags/raspberrypi.html">raspberrypi (1)</a></li><li><a href="/blog/tags/example.html">example (1)</a></li></ol><h2>By Year</h2><ol><li><a href="/blog/2015.html">2015 (15)</a></li></ol></aside></div></body></html>