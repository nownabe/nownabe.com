<!DOCTYPE html><html><head><meta charset="utf-8" /><title>nownab.log - RubotyのデータをLevelDBで永続化するruboty-leveldbというGemを作った</title><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><link href="https://storage.googleapis.com/code.getmdl.io/1.0.4/material.light_blue-pink.min.css" rel="stylesheet" /><script src="https://storage.googleapis.com/code.getmdl.io/1.0.0/material.min.js"></script><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" /><link href="../../../../stylesheets/blog.css" rel="stylesheet" /><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" /></head><body><div class="mdl-layout mdl-js-layout" id="container"><header><h1 id="title"><a href="/blog">nownab.log</a><small><i class="material-icons md-18">description</i><span id="subtitle">logger.level = Logger::DEBUG</span></small></h1></header><div id="main" role="main"><h1 id="section">経緯</h1>
<p>会社でチャットボットとして<a href="https://github.com/r7kamura/ruboty">Ruboty</a>を使ってます。</p>

<p>Rubotyはデータの永続化にプラグインを使わないといけないんですが、今はRedis用のプラグインしか用意されていません。
（もしかしたら誰か作ってるのがあるかも）</p>

<p>おそらく、RubotyはHeroku + Redis To Goのような環境で運用されることを想定されていて、Redis用のプラグインしかないんだと思います。
プライベートで使ってるのはその構成なんですが、会社では自前のサーバでDockerコンテナとして動作させています。</p>

<p>外部のサーバに置きたくなくてそうしてるのでデータも内部に持ちたかったんですが、RubotyのためだけにRedisサーバ運用するのもなんだかなーとしばらくデータ永続化せずに使ってました。</p>

<p>けどこのままはアカンなーということで、<a href="https://github.com/google/leveldb">LevelDB</a>を使ってRubotyのデータを永続化できる<a href="https://rubygems.org/gems/ruboty-leveldb">ruboty-leveldb</a>というプラグインを作成しました！</p>

<h1 id="leveldb">なぜLevelDB？</h1>
<p>正直言うと、余分なサーバ建てずにデータの永続化ができればテキストファイルでも他のKVSでもなんでも良かったんですが、使ってみたかったのでLevelDBにしました。</p>

<p>Rubotyのデータぐらいだと、LevelDBが他のKVSに比べてどういいのかとかは全然見えません。</p>

<p>個人的には<a href="http://fallabs.com/kyotocabinet/">KyotoCabinet</a>が好きで使ってたんですが、ほぼ同じ感覚で使えました。
LevelDBが流行りならLevelDBでも全然いいなーという感想です。</p>

<p>LevelDBについてはここがまとまってました。</p>

<ul>
  <li><a href="http://yosuke-furukawa.hatenablog.com/entry/2014/05/05/095207">LevelDB入門 (基本編)</a></li>
</ul>

<h1 id="section-1">使い方</h1>
<p>Qiitaに書きました。</p>

<ul>
  <li><a href="http://qiita.com/nownabe/items/06977acec7f08133d8c9">Rubotyのデータ永続化にLevelDBを使う</a></li>
</ul>

<h1 id="section-2">感想</h1>
<p>Rubotyまわりはとてもコードが綺麗でよく見てるんですが、本当に参考になります。
ruboty-leveldbもほとんど<a href="https://github.com/r7kamura/ruboty-redis">ruboty-redis</a>まんまですw</p>

<p>…今気づいたんですがRubotyのREADMEでruboty-leveldbが紹介されてる…！！
ありがとうございます！！</p>

<p>[https://github.com/r7kamura/ruboty:embed]</p>
</div><aside><h2>Recent Articles</h2><ol><li><a href="/blog/2015/09/22/test.html">Example Article</a><span>Sep 22</span></li><li><a href="/blog/2015/08/31/redundant-geminabox.html">Gem in a Boxの冗長化</a><span>Aug 31</span></li><li><a href="/blog/2015/08/10/idcf-dns.html">お名前.comからIDCF DNSに移行した話</a><span>Aug 10</span></li><li><a href="/blog/2015/08/09/raspberry-pi-lchika.html">今更Raspberry PiでLチカやってみた</a><span>Aug  9</span></li><li><a href="/blog/2015/05/24/intro-headphone-amp.html">機材紹介：ヘッドホンアンプ</a><span>May 24</span></li><li><a href="/blog/2015/05/21/backup-to-idcf.html">超簡単にサーバのデータをIDCFオブストに定期バックアップするItamaeプラグイン</a><span>May 21</span></li><li><a href="/blog/2015/05/20/release-to-geminabox.html">Gem in a Boxに簡単にリリースできるGem作ったけどいっぱいあったのでまとめ</a><span>May 20</span></li><li><a href="/blog/2015/05/17/intro-wind-chime.html">機材紹介：ウィンドチャイム</a><span>May 17</span></li><li><a href="/blog/2015/04/19/github-pages.html">Github Pagesが便利すぎてイイ</a><span>Apr 19</span></li><li><a href="/blog/2015/03/14/serverfesta.html">サバフェス始まりました</a><span>Mar 14</span></li></ol><h2>Tags</h2><ol><li><a href="/blog/tags/band.html">band (2)</a></li><li><a href="/blog/tags/instruments.html">instruments (3)</a></li><li><a href="/blog/tags/drums.html">drums (2)</a></li><li><a href="/blog/tags/tech.html">tech (8)</a></li><li><a href="/blog/tags/ruby.html">ruby (4)</a></li><li><a href="/blog/tags/geminabox.html">geminabox (2)</a></li><li><a href="/blog/tags/itamae.html">itamae (1)</a></li><li><a href="/blog/tags/idcf.html">idcf (2)</a></li><li><a href="/blog/tags/diary.html">diary (4)</a></li><li><a href="/blog/tags/leveldb.html">leveldb (1)</a></li><li><a href="/blog/tags/ruboty.html">ruboty (1)</a></li><li><a href="/blog/tags/dns.html">dns (1)</a></li><li><a href="/blog/tags/raspberrypi.html">raspberrypi (1)</a></li><li><a href="/blog/tags/example.html">example (1)</a></li></ol><h2>By Year</h2><ol><li><a href="/blog/2015.html">2015 (15)</a></li></ol></aside></div></body></html>